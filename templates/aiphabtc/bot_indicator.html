{% extends "base.html" %}
{% load static %}
{% load aiphabtc_filter %}
{% load humanize %}

{% block content %}
<div class="container mt-5">
    <h3><img src="{% static 'aiphabtc_robot_pic.png' %}" alt="Robot Assistant Icon" style="height: 30px; margin-right: 5px;">머신러닝 비트코인 가격 예측 지표</h3>
    <hr>
    <p>업비트 차트를 기반으로 가벼운 머신러닝 예측을 수행했습니다. 다양한 시간대를 포함한 보다 <strong>강력한</strong> 현물/선물 머신러닝 지표와 투자 봇도 개발중입니다.</p>

    <h5 class="mt-4"><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">단기 방향성 예측 지표</h5>
    <small>오늘 오전 9시 종가를 기준으로 내일 오전 9시 종가 방향성의 확률을 예측합니다. 튜닝이 되지 않은 가벼운 모델이니 참고만 해주세요. "+" 또는 "-"를 누루면 모델이 예측한 각각의 확률을 볼 수 있습니다.</small>

    <div class="my-4 p-3 bg-light rounded">
        <div class="my-4 p-3 bg-light rounded">
            <h5>XGBoost 예측</h5>
            <div class="progress" style="height: 30px;">
                <div class="progress-bar bg-danger" role="progressbar" style="width: {{ xgb_short|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ xgb_short|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="내린다 {{ xgb_short|floatformat:2 }}%">-</div>
                <div class="progress-bar bg-success" role="progressbar" style="width: {{ xgb_long|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ xgb_long|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="오른다 {{ xgb_long|floatformat:2 }}%">+</div>
            </div>
        </div>
        <div class="my-4 p-3 bg-light rounded">
            <h5 class="mb-3">LightGBM 예측</h5>
            <div class="progress" style="height: 30px;">
                <div class="progress-bar bg-danger" role="progressbar" style="width: {{ lgb_short|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ lgb_short|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="내린다 {{ lgb_short|floatformat:2 }}%">-</div>
                <div class="progress-bar bg-success" role="progressbar" style="width: {{ lgb_long|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ lgb_long|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="오른다 {{ lgb_long|floatformat:2 }}%">+</div>
            </div>
        </div>
        <div class="my-4 p-3 bg-light rounded">
            <h5 class="mb-3">RandomForest 예측</h5>
            <div class="progress" style="height: 30px;">
                <div class="progress-bar bg-danger" role="progressbar" style="width: {{ rf_short|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ rf_short|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="내린다 {{ rf_short|floatformat:2 }}%">-</div>
                <div class="progress-bar bg-success" role="progressbar" style="width: {{ rf_long|floatformat:2 }}%;" data-bs-toggle="tooltip" aria-valuenow="{{ rf_long|floatformat:2 }}" aria-valuemin="0" aria-valuemax="100" title="오른다 {{ rf_long|floatformat:2 }}%">+</div>
            </div>
        </div>
    </div>
    <hr style="height: 2px; background-color: black;">
    <h5><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">단기 시계열 예측 지표</h5>
    <p>오늘 오전 9시 종가를 기준으로 내일 오전 9시 종가를 예측해봅니다.</p>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Method</th>
                <th>Predicted Price</th>
                <th>Change Rate</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ElasticNet 회귀</td>
                <td><strong>{{ elasticnet_prediction|floatformat:2|intcomma }} KRW</strong></td>
                <td><strong class="{% if elasticnet_percentage_change >= 0 %}text-success{% else %}text-danger{% endif %}">{% if elasticnet_percentage_change >= 0 %}+{% endif %}{{ elasticnet_percentage_change|floatformat:2 }}%</strong></td>
            </tr>
            <tr>
                <td>ARIMA</td>
                <td><strong>{{ arima_prediction|floatformat:2|intcomma }} KRW</strong></td>
                <td><strong class="{% if arima_percentage_change >= 0 %}text-success{% else %}text-danger{% endif %}">{% if arima_percentage_change >= 0 %}+{% endif %}{{ arima_percentage_change|floatformat:2 }}%</strong></td>
            </tr>
            <tr>
                <td>다층 퍼셉트론</td>
                <td><strong>{{ mlp_prediction|floatformat:2|intcomma }} KRW</strong></td>
                <td><strong class="{% if mlp_percentage_change >= 0 %}text-success{% else %}text-danger{% endif %}">{% if mlp_percentage_change >= 0 %}+{% endif %}{{ mlp_percentage_change|floatformat:2 }}%</strong></td>
            </tr>
        </tbody>
    </table>
    <br><br>
</div>
{% endblock %}

{% block javascript %}
{{ block.super }}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Initialize tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>
{% endblock %}