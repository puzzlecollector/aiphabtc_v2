{% extends "base.html" %}
{% load static %}
{% load aiphabtc_filter %}
{% load humanize %}

{% block head %}
{{ block.super }}
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
<style>
    a {
        text-decoration: none; /* Remove underline */
        color: #007bff; /* Bootstrap default blue color for links */
    }
    .news-table {
        width: 100%;
        border-collapse: collapse;
    }
    .news-row {
        display: table-row;
    }
    .news-cell {
        display: table-cell;
        padding: 10px;
        border-bottom: 1px solid #ddd;
        position: relative; /* for tooltip positioning */
        text-align: center; /* Center text within the cell */
    }
    .title-cell {
        font-weight: bold;
        color: #333;
        cursor: help; /* indicates that a tooltip is available */
    }
    .datetime-cell {
        color: #666;
        font-size: 0.9em;
    }
    /* Tooltip styling */
    .title-cell:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        left: 50%; /* Start from the middle of the cell */
        transform: translateX(-50%); /* Center the tooltip */
        bottom: 100%; /* Position above the title */
        margin-bottom: 10px; /* Lift the tooltip up */
        background-color: #333;
        color: white;
        padding: 10px 15px;
        border-radius: 6px;
        font-size: 0.9em;
        z-index: 10;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        max-width: 400px;
        white-space: normal;
        text-align: left;
        overflow-y: auto;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        opacity: 0;
        visibility: hidden;
    }
    .title-cell:hover::after {
        opacity: 1;
        visibility: visible;
    }
    .sentiment-scores {
        margin: 20px 0;
    }

    .sentiment-score {
        background-color: #f2f2f2;
        border-radius: 5px;
        overflow: hidden;
        position: relative;
        margin-bottom: 10px;
    }

    .sentiment-bar {
        height: 20px;
        background-color: #4caf50;
        transition: width 0.3s ease;
    }

    .sentiment-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-weight: bold;
    }

    .voting-container {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 300px; /* Adjust based on your needs */
    }

    .voting-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,.1);
        margin-top: 20px;
    }

    .voting-container form {
        width: 100%;
    }

    .voting-container .form-check {
        margin: 10px 0;
    }

    .voting-container .form-check-input {
        cursor: pointer;
    }

    .voting-container .form-check-label {
        cursor: pointer;
        font-weight: 500;
    }

    .voting-container button[type="submit"] {
        width: 100%;
        margin-top: 20px;
    }

    .tradingview-widgets {
        display: flex;
        justify-content: space-between;
    }

    .tradingview-widget-container {
        margin: 0 auto;
        width: 100%; /* Responsive width */
    }

    .dominance-container {
      padding: 10px;
      border: 1px solid #ddd; /* Adds a subtle border */
      border-radius: 8px; /* Rounded corners for better aesthetics */
      box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* Soft shadow for depth */
    }

    .investment-calendar-container {
        text-align: center;
        padding: 10px;
        background-color: #fff; /* Light background for the container */
        border: 1px solid #ccc; /* Subtle border */
        border-radius: 10px; /* Rounded corners */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
        margin: 20px auto;
        width: 100%; /* Full width to accommodate smaller screens */
        max-width: 999px; /* Maximum width to maintain aesthetics */
    }

    .investment-calendar-container iframe {
        display: block;
        margin: 0 auto;
        width: 100%; /* Responsive width */
        height: 450px; /* Height adjustment for better visibility */
        border: none; /* Removing the default border */
    }

    .poweredBy {
        font-size: 0.75rem; /* Smaller font size for the attribution */
        color: #666; /* Subdued color for less attention */
        margin-top: 10px;
        text-align: center;
    }

    .advertisement-container {
        text-align: center; /* Center the advertisement */
        margin: 20px 0; /* Add some space around the ad */
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Optional: Adds a subtle shadow around the ad for depth */
        border-radius: 8px; /* Optional: Rounds the corners of the ad container */
        overflow: hidden; /* Ensures the border-radius clips the image if needed */
    }

    .advertisement-image {
        width: 100%; /* Ensures the image fills the container */
        transition: transform 0.3s ease; /* Smoothly scales the image on hover */
    }

    .advertisement-container:hover .advertisement-image {
        transform: scale(1.05); /* Slightly enlarges the image on hover for a subtle interactive effect */
    }

    .ad-label {
        display: block;
        text-align: center;
        margin-bottom: 8px;
        font-size: 0.8rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .footer {
        text-align: center; /* Center-align text */
        padding: 20px; /* Add some padding */
        background-color: #f2f2f2; /* Light grey background */
        color: #333; /* Darker text color for contrast */
        font-size: 0.9rem; /* Adjust the font size */
        border-top: 1px solid #ddd; /* Add a top border line */
        margin-top: 20px; /* Add some space above the footer */
    }

    .column-divider:not(:last-child) {
        border-right: 2px solid #dee2e6;
    }

    .list-group-item-announcement {
        background-color: #e6f4ea; /* Light green background */
        border-left: 3px solid #28a745; /* Darker green line on the left side */
    }

    .btn-group .btn {
        margin-right: 5px; /* Adds space between buttons */

    }

    .btn-group .btn:hover {
        background-color: #0056b3; /* Darker shade on hover for better UI interaction */
    }

    .dominance-chart {
        height: 100%; /* Ensures the trading view container fills its parent */
        padding: 0;
        margin: 0 auto; /* Centers the chart if necessary */
        width: 100%; /* Ensures full width */
    }

    .chart-container {
        width: 100%; /* Full width */
        height: 400px; /* Adjust height dynamically based on viewport */
        transition: height 0.5s ease-in-out; /* Smooth transition for resizing, optional */
    }

    .additional-news {
        margin-top: 20px;
        padding: 15px;
        background-color: #f8f9fa; /* Light gray background to distinguish this section */
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* Soft shadow for depth */
    }

    .additional-news-heading {
        color: #333; /* Dark grey for text */
        font-size: 18px;
        margin-bottom: 10px; /* Space between heading and list */
    }

    .news-links li {
        margin-bottom: 5px; /* Space between items for better readability */
        font-size: 14px; /* Suitable font size for details */
        line-height: 1.6; /* Increased line height for readability */
        color: #555; /* Slightly lighter text for easy reading */
    }

    .news-links strong {
        color: #007bff; /* Bootstrap primary blue for emphasis */
    }

    @media (max-width: 999px) {
        .container, .voting-container, .advertisement-container {
            padding: 10px;
            margin-top: 10px;
        }

        .investment-calendar-container {
            text-align: center;
            padding: 10px;
        }

        .investment-calendar-container ifrmae {
            width:100%;
            height:300px;
            display:block;
            margin: 0 auto;
        }

        .poweredBy {
            text-align: center;
            font-size: 0.75rem;
            maring-top: 10px;
        }


        .chart-container {
            height: auto; /* More flexible on mobile devices */
            padding-bottom: 20px; /* Extra bottom padding on smaller screens */
        }

        .advertisement-container {
            width: 50%; /* Each advertisement takes up half the width */
            display: inline-block; /* Inline-block for side-by-side layout */
            margin: 0 0 10px 0; /* Adjust margins as needed */
            margin-top: 30px;
            margin-bottom: 20px;
            padding: 0; /* Remove padding if necessary */
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
        }

        .news-cell {
            display: block; /* Stacks the news cells vertically */
            padding: 5px 0; /* Reduce padding for smaller screens */
        }

        .title-cell, .datetime-cell {
            text-align: left; /* Aligns text to the left for consistency */
            padding: 10px 5px; /* Adjust padding for smaller spaces */
        }

        .tradingview-widget-container {
            margin: 0; /* Remove margins */
            height: auto; /* Adjust height automatically */
            margin-bottom: 35px;
        }

        .tradingview-widget-container__widget {
            width: 100%; /* Full width */
            height: auto; /* Auto height for flexibility */
        }

        .sentiment-scores, .investment-calendar-container, .voting-container {
            margin-top: 0; /* Reduce margin to save space */
        }

        .btn-group {
            display: block; /* Stack buttons vertically */
            width: 100%;
        }

        .btn-group .btn {
            margin-bottom: 5px; /* Add space between stacked buttons */
        }

        .footer {
            padding: 10px; /* Reduce padding */
        }

        .dominance-container {
            padding: 5px;
            margin: 5px;
        }
    }

    .list-group-item-popular {
        background-color: #fff5f5; /* Light red background */
        border-left: 3px solid red; /* Red line on the left side */
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} mt-4" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    <div class="row">
        <div class="col-lg-12">
            <h3><img src="{% static 'aiphabtc_robot_pic.png' %}" alt="Robot Assistant Icon" style="height: 30px; margin-right: 5px;">ì•„ì´íŒŒë¹„íŠ¸ ëŒ€ì‹œë³´ë“œ</h3>
            <hr>
            <!-- Dashboard content here -->
            <div class="btn-group mb-3 d-inline-block" role="group" aria-label="Platform Toggle">
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://coinone.co.kr/user/signup?ref=2XBNWZCO"><img src="{% static 'coinone.jpeg' %}" alt="settings" style="height:20px; margin-right: 5px;">coinone</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.binance.info/en/activity/referral-entry/CPA/together-v3?ref=CPA_00UWK2KRRU"><img src="{% static 'binance.png' %}" alt="settings" style="height:20px; margin-right: 5px;">Binance</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.bybit.com/invite?ref=ZJXVJ"><img src="{% static 'bybit.png' %}" alt="settings" style="height:20px; margin-right: 5px;">Bybit</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://okx.com/join/76981790"><img src="{% static 'okx.png' %}" alt="settings" style="height:20px; margin-right: 5px;">OKX</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.mexc.com/ko-KR/register?inviteCode=mexc-1RwmG"><img src="{% static 'mexc.png' %}" alt="settings" style="height:20px; margin-right: 5px;">MEXC</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.gate.io/signup/BVRMUw0J?ref_type=103"><img src="{% static 'gate_io.jpeg' %}" alt="settings" style="height:20px; margin-right: 5px;">Gate.io</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://warpcast.com/~/invite-page/300591?id=bd816494"><img src="{% static 'warpcast.jpeg' %}" alt="settings" style="height:20px; margin-right: 5px;">Warpcast</a>
                </button>
                <!--
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.coinbase.com/"><img src="{% static 'coinbase.png' %}" alt="settings" style="height:20px; margin-right: 5px;">Coinbase</a>
                </button>
                -->
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.bitget.com/en-GB/register?inviteCode=FPKX1RFE"><img src="{% static 'bitget.jpeg' %}" alt="settings" style="height:20px; margin-right: 5px;">Bitget</a>
                </button>
                <!--
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.pionex.com/en/"><img src="{% static 'pionex.png' %}" alt="settings" style="height:20px; margin-right: 5px;">Pionex</a>
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm">
                    <a href="https://www.bydfi.com/en"><img src="{% static 'bydfi.png' %}" alt="settings" style="height:20px; margin-right: 5px;">BYDFI</a>
                </button>
                -->
            </div>
            <br>
            <div class="row">
                <div class="col-lg-6 column-divider">
                    <p><a href="{% url 'aiphabtc:bot_indicator' %}">â¡ï¸ì•„ì´íŒŒë¹„íŠ¸ ì¸ê³µì§€ëŠ¥ ë° í†µê³„ê¸°ë°˜ ë¹„íŠ¸ì½”ì¸ íˆ¬ìë´‡ ì§€í‘œğŸ“ˆğŸ“ˆ</a></p>
                    <p><a href="{% url 'aiphabtc:pattern_matching' %}">â¡ï¸ì•„ì´íŒŒë¹„íŠ¸ ì¸ê³µì§€ëŠ¥ ê¸°ë°˜ ë¹„íŠ¸ì½”ì¸ íŒ¨í„´ë§¤ì¹­ ì§€í‘œğŸ“ˆğŸ“ˆ</a></p>
                    <h5 class="mb-3"><a href="https://upbit.com/exchange?code=CRIX.UPBIT.KRW-BTC"><img src="{% static 'upbit.png' %}" alt="settings" style="height:20px; margin-right: 10px;"></a>BTC-KRW ì‹œí™©</h5>
                    <!-- TradingView Widget -->
                    <div class="tradingview-widget-container">
                          <div class="tradingview-widget-container__widget" style="height:400px;width:100%">
                              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                                  {
                                      "autosize": false,
                                      "symbol": "UPBIT:BTCKRW",
                                      "interval": "D",
                                      "timezone": "Etc/UTC",
                                      "theme": "light",
                                      "style": "1",
                                      "locale": "en",
                                      "toolbar_bg": "#f1f3f6",
                                      "enable_publishing": false,
                                      "allow_symbol_change": true,
                                      "studies": [
                                        "STD;RSI"
                                      ],
                                      "container_id": "tradingview_3e3e3"
                                  }
                              </script>
                          </div>
                    </div>
                    <div class="row" style="text-align: left; margin-top: 10px;">
                        <!-- Daily Analysis Button and Output -->
                        <div class="col-md-6 flex-column align-items-center">
                            <button id="fetchTechnicalAIResponse" class="btn btn-primary">AI ì¼ë´‰ ì¶”ì„¸ ë¶„ì„ ë³´ê¸°</button>
                            <div id="TechnicalLoading" style="display:none;">AIê°€ ë¶„ì„ì¤‘... ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</div>
                            <p id="TechnicalAIResponse">{{ technical_chat_message }}</p>
                        </div>

                        <!-- Monthly Analysis Button and Output -->
                        <div class="col-md-6 flex-column align-items-center">
                            <button id="fetchTechnicalAIResponse1m" class="btn btn-secondary">AI ì›”ë´‰ ì¶”ì„¸ ë¶„ì„ ë³´ê¸°</button>
                            <div id="TechnicalLoading1m" style="display:none;">AIê°€ ë¶„ì„ì¤‘... ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</div>
                            <p id="TechnicalAIResponse1m">{{ technical_chat_message_1m }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="search-container">
                        <form action="{% url 'aiphabtc:search_results' %}" method="get" class="row gx-2">
                            <div class="col">
                                <input class="form-control form-control-lg" type="search" placeholder="Search" aria-label="Search" name="q">
                            </div>
                            <div class="col-auto">
                                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">í¬ìŠ¤íŠ¸ ê²€ìƒ‰</button>
                            </div>
                        </form>
                    </div>
                    <div class="container mt-4">
                        <h4 class="mb-3">ğŸ“¢ ê³µì§€ì‚¬í•­</h4>
                        <ul class="list-group list-group-flush">
                            {% for post in announcement_posts %}
                            <li class="list-group-item list-group-item-announcement">
                                <a href="{% url 'aiphabtc:detail' post.id %}">{{ post.subject }}</a>
                                <span class="badge bg-success float-end">{{ post.create_date|date:"Y-m-d" }}</span>
                            </li>
                            {% empty %}
                            <li class="list-group-item">ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="container mt-3">
                        <h4 class="mb-3"><span style="color: red;">ğŸ”¥ ì¸ê¸°ê¸€ ğŸ”¥</span></h4>
                                    <ul class="list-group list-group-flush">
                            {% for post in popular_posts %}
                            <li class="list-group-item list-group-item-popular">
                                <a href="{% url 'aiphabtc:detail' post.id %}">
                                    {{ post.subject }}
                                </a>
                                <span class="badge bg-danger float-end">{{ post.create_date|date:"Y-m-d" }}</span>
                            </li>
                            {% empty %}
                            <li class="list-group-item">ì¸ê¸°ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            <hr style="height: 5px; background-color: green;">
                <div class="row">
                    {% for board, posts in board_posts.items %}
                        {% if board.name != 'blockchain' and board.name != 'economics' and board.name != 'general_qa' and board.name != 'announcements' %}
                            <div class="col-12 mb-4">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <h5>
                                            {% if board.name == 'free_board' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'free_board' %}">ììœ ê²Œì‹œíŒ</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ììœ ë¡­ê²Œ ì•„ë¬´ ì£¼ì œì— ëŒ€í•œ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”">[?]</span>
                                            {% elif board.name == 'AI' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'AI' %}">ì¸ê³µì§€ëŠ¥</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ì¸ê³µì§€ëŠ¥ê³¼ ì–´ë–»ê²Œ ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹ì„ ì½”ì¸ íŠ¸ë ˆì´ë”©ì— ì ‘ëª©ì‹œí‚¬ ìˆ˜ ìˆëŠ”ì§€ì— ê´€í•œ ì •ë³´ê¸€ì„ ê³µìœ í•˜ëŠ” ê³³ì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'general_qa' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'general_qa' %}">ì§ˆë¬¸ê³¼ ë‹µë³€</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ì§ˆë¬¸ê³¼ ë‹µë³€ìœ¼ë¡œ ì •ë³´ê³µìœ ë¥¼ í•˜ëŠ” ê²Œì‹œíŒì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'trading' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'trading' %}">ì½”ì¸ ì§€ì‹</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ì•”í˜¸í™”íì™€ íŠ¸ë ˆì´ë”©ì— ê´€ë ¨ëœ ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” ê³³ì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'perceptive_board' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'perceptive_board' %}">ê´€ì ê³µìœ  ê²Œì‹œíŒ</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ë¹„íŠ¸ì½”ì¸ ë° ì—…ë¹„íŠ¸ì— ìƒì¥ëœ ì•ŒíŠ¸ì½”ì¸ì— ëŒ€í•œ ê´€ì ì„ ììœ ë¡­ê²Œ ì‘ì„±í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'blockchain' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'blockchain' %}">ë¸”ë¡ì²´ì¸</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ë¸”ë¡ì²´ì¸ ê¸°ìˆ ì— ê´€ë ¨ëœ ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” ê³³ì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'economics' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'economics' %}">ê²½ì œ ë° ì‹œí™©</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ìµœê·¼ ê²½ì œì™€ ì‹œí™©ì´ ì–´ë–»ê²Œ ë¹„íŠ¸ì½”ì¸ê³¼ ì•”í˜¸í™”íì— ì˜í–¥ì„ ë¯¸ì¹ ì§€ì— ëŒ€í•´ ë…¼ì˜í•˜ê³  ê²½ì œ ê³µë¶€ì™€ ì •ë³´ê³µìœ ë¥¼ í•˜ëŠ” ê³³ì…ë‹ˆë‹¤">[?]</span>
                                            {% elif board.name == 'creator_reviews' %}
                                            <a href="{% url 'aiphabtc:board_filtered' 'creator_reviews' %}">ë°©ì†¡ê³¼ ì±… ë¦¬ë·°</a>
                                            <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ì½”ì¸ ë°©ì†¡ í¬ë¦¬ì—ì´í„°ì™€ ê´€ë ¨ ì„œì ì— ê´€í•œ ë¦¬ë·° ë° ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” ê³³ì…ë‹ˆë‹¤">[?]</span>
                                            {% else %}
                                            {{ board.name }}
                                            {% endif %}
                                        </h5>
                                    </div>
                                    <ul class="list-group list-group-flush">
                                        {% for post in posts %}
                                        <li class="list-group-item">
                                            <a href="{% url 'aiphabtc:detail' post.id %}">
                                                {{ post.subject }}
                                            </a>
                                            <span class="badge bg-info float-end">{{ post.create_date|date:"Y-m-d" }}</span>
                                        </li>
                                        {% empty %}
                                        <li class="list-group-item">No posts yet</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            <hr style="height: 5px; background-color: green;">
            <p>
                <div class="row">
                    <div class="col-lg-4 column-divider">
                        <strong><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">í¬ë¦½í†  ê³µí¬ íƒìš• ì§€ìˆ˜</strong>
                        <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="í¬ë¦½í†  ê³µí¬ì™€ íƒìš• ì§€ìˆ˜ëŠ” íˆ¬ììë“¤ì˜ ì‹œì¥ì— ëŒ€í•œ ê°ì •ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ ì¤‘ í•˜ë‚˜ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì§€ìˆ˜ëŠ” 0ì—ì„œ 100 ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ë©°, 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íˆ¬ììë“¤ì´ ë‘ë ¤ì›€ì„ ëŠë¼ê³  ìˆìŒì„, 100ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íƒìš•ì ì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ ì§€ìˆ˜ëŠ” ì£¼ë¡œ ì‹œì¥ì˜ ê·¹ë‹¨ì ì¸ ê°ì • ìƒíƒœë¥¼ í¬ì°©í•´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œì˜ ë³€í™”ë¥¼ ì˜ˆì¸¡í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì§€ìˆ˜ê°€ íƒìš•ìœ¼ë¡œ ì˜®ê²¨ê°€ë©´ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ ì˜¤ë¥¼ ê°€ëŠ¥ì„±ì´ ìˆì§€ë§Œ, ì´ëŠ” ë˜í•œ ê°€ê²©ì´ ê³¼ì—´ë˜ì–´ ì¡°ì •ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì‹œì ì— ì ‘ì–´ë“¤ ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.">[?]</span>
                        <!--<span class="tooltip-question-mark" data-toggle="tooltip" data-html="true" title="í¬ë¦½í†  ê³µí¬ì™€ íƒìš• ì§€ìˆ˜ëŠ” íˆ¬ììë“¤ì˜ ì‹œì¥ì— ëŒ€í•œ ê°ì •ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œ ì¤‘ í•˜ë‚˜ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì§€ìˆ˜ëŠ” 0ì—ì„œ 100 ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ë©°, 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íˆ¬ììë“¤ì´ ë‘ë ¤ì›€ì„ ëŠë¼ê³  ìˆìŒì„, 100ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íƒìš•ì ì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ ì§€ìˆ˜ëŠ” ì£¼ë¡œ ì‹œì¥ì˜ ê·¹ë‹¨ì ì¸ ê°ì • ìƒíƒœë¥¼ í¬ì°©í•´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œì˜ ë³€í™”ë¥¼ ì˜ˆì¸¡í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì§€ìˆ˜ê°€ íƒìš•ìœ¼ë¡œ ì˜®ê²¨ê°€ë©´ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì´ ì˜¤ë¥¼ ê°€ëŠ¥ì„±ì´ ìˆì§€ë§Œ, ì´ëŠ” ë˜í•œ ê°€ê²©ì´ ê³¼ì—´ë˜ì–´ ì¡°ì •ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ì‹œì ì— ì ‘ì–´ë“¤ ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.">[?]</span>-->
                        <p>ë¹„íŠ¸ì½”ì¸ ë° ê¸°íƒ€ ëŒ€í˜• ì•”í˜¸í™”íë¥¼ ìœ„í•œ ìµœê·¼ 5ë™ì•ˆì˜ ê³µí¬ íƒìš• ì§€ìˆ˜ì…ë‹ˆë‹¤ <a href="https://alternative.me/crypto/fear-and-greed-index/">[ì°¸ê³ ]</a></p>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Value</th>
                                    <th>Classification</th>
                                </tr>
                            </thead>
                            <tbody>
                            {% for row in data_fng %}
                                <tr>
                                    <td>{{ row.timestamp }}</td>
                                    <td>{{ row.value }}</td>
                                    <td>{{ row.value_classification }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="col-lg-4 column-divider">
                        <strong><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">ê¸€ë¡œë²Œ í¬ë¦½í†  ì‹œì¥ ì •ë³´</strong>
                        <p>ì•”í˜¸í™”í ì‹œì¥ì˜ ì „ë°˜ì ì¸ ì •ë³´ì…ë‹ˆë‹¤ <a href="https://www.coinlore.com/ko/cryptocurrency-data-api">[ì°¸ê³ ]</a></p>
                        <table class="table">
                            {% for row in data_global %}
                                <tr>
                                    <th>ì½”ì¸ ìˆ˜</th>
                                    <td>{{ row.coins_count|intcomma }}</td>
                                </tr>
                                <tr>
                                    <th>í™œì„± ì‹œì¥</th>
                                    <td>{{ row.active_markets|intcomma }}</td>
                                </tr>
                                <tr>
                                    <th>ì‹œê°€ ì´ì•¡ ($)</th>
                                    <td>{{ row.total_mcap |floatformat:2 |intcomma }}</td>
                                </tr>
                                <tr>
                                    <th>ì´ ê±°ë˜ëŸ‰ ($)</th>
                                    <td>{{ row.total_volume |floatformat:2 |intcomma }}</td>
                                </tr>
                                <tr>
                                    <th>ì‹œê°€ ì´ì•¡ ë³€í™” (%)</th>
                                    <td class="{% if row.mcap_change|to_float >= 0 %}text-success{% else %}text-danger{% endif %}">
                                        {% if row.mcap_change|to_float >= 0 %}+{% endif %}{{ row.mcap_change|floatformat:2 }}
                                    </td>
                                </tr>
                                <tr>
                                    <th>ê±°ë˜ëŸ‰ ë³€í™” (%)</th>
                                    <td class="{% if row.volume_change|to_float >= 0 %}text-success{% else %}text-danger{% endif %}">
                                        {% if row.volume_change|to_float >= 0 %}+{% endif %}{{ row.volume_change|floatformat:2 }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                    <div class="col-lg-4 column-divider">
                        <strong><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">ê¹€ì¹˜ í”„ë¦¬ë¯¸ì—„ ì •ë³´</strong>
                        <span style="color: black; cursor: help;" data-bs-toggle="tooltip" data-bs-placement="top" title="ê¹€ì¹˜ í”„ë¦¬ë¯¸ì—„ì´ë€ ìš©ì–´ëŠ” í•œêµ­ì˜ ì•”í˜¸í™”í ê°€ê²©ì´ í•´ì™¸ ê±°ë˜ì†Œì˜ ê°€ê²©ë³´ë‹¤ ë†’ì„ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê¹€í”„ê°€ ë†’ë‹¤ëŠ” ê²ƒì€ í•´ì™¸ ê±°ë˜ì†Œì—ì„œ ìƒì¥ëœ ì½”ì¸ì˜ ê°€ê²©ì´ í•œêµ­ ë‚´ì—ì„œ ê±°ë˜ë˜ëŠ” ê°€ê²©ë³´ë‹¤ ìƒëŒ€ì ìœ¼ë¡œ ì €ë ´í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.">[?]</span>
                        <!--<span class="tooltip-question-mark" data-toggle="tooltip" data-html="true" title="ê¹€ì¹˜ í”„ë¦¬ë¯¸ì—„ì´ë€ ìš©ì–´ëŠ” í•œêµ­ì˜ ì•”í˜¸í™”í ê°€ê²©ì´ í•´ì™¸ ê±°ë˜ì†Œì˜ ê°€ê²©ë³´ë‹¤ ë†’ì„ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê¹€í”„ê°€ ë†’ë‹¤ëŠ” ê²ƒì€ í•´ì™¸ ê±°ë˜ì†Œì—ì„œ ìƒì¥ëœ ì½”ì¸ì˜ ê°€ê²©ì´ í•œêµ­ ë‚´ì—ì„œ ê±°ë˜ë˜ëŠ” ê°€ê²©ë³´ë‹¤ ìƒëŒ€ì ìœ¼ë¡œ ì €ë ´í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.">[?]</span>-->
                        <p>ë¹„íŠ¸ê²Ÿê³¼ ì—…ë¹„íŠ¸ì—ì„œ ê°€ì ¸ì˜¨ BTC ê°€ê²© ì •ë³´ë¡œ ê³„ì‚°ëœ ìˆ˜ì¹˜ì…ë‹ˆë‹¤ (ë¹„íŠ¸ê²Ÿ/ì—…ë¹„íŠ¸ í”„ë¦¬ë¯¸ì—„)</p>
                        <table class="table">
                            <tr>
                                <th>ê°€ì¥ ìµœê·¼ ì¡°íšŒ ì‹œê°„</th>
                                <td>{{ kimchi_data.current_time }}</td>
                            </tr>
                            <tr>
                                <th>USD/KRW</th>
                                <td>{{ kimchi_data.now_usd_krw |floatformat:2 |intcomma }}</td>
                            </tr>
                            <tr>
                                <th>BTC ê°€ê²© (KRW)</th>
                                <td>{{ kimchi_data.now_upbit_price |floatformat:2 |intcomma }}</td>
                            </tr>
                            <tr>
                                <th>BTC ê°€ê²© (USDT)</th>
                                <td>{{ kimchi_data.now_bitget_price |floatformat:2 |intcomma }}</td>
                            </tr>
                            <tr>
                                <th>BTC ê¹€í”„ (%)</th>
                                <td class="{% if kimchi_data.kp|to_float >= 0 %}text-success{% else %}text-danger{% endif %}">
                                    {% if kimchi_data.kp|to_float >= 0 %}+{% endif %}{{ kimchi_data.kp |floatformat:2 }}
                                </td>
                            </tr>
                        </table>
                    </div>
                    <!--
                    <div class="col-lg-3">
                        <strong><img src="{% static 'aiphabtc_sub_logo.png' %}" alt="Robot Assistant Icon" style="height: 20px; margin-right: 5px;">ì‹œì¥ ìƒê´€ê´€ê³„ ë¶„ì„</strong>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜ (Pearson)</th>
                                    <td>{{ pearson|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <th>ìŠ¤í”¼ì–´ë§Œ ìƒê´€ê³„ìˆ˜ (Spearman)</th>
                                    <td>{{ spearman|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <th>ì¼„ë‹¬ ìƒê´€ê³„ìˆ˜ (Kendall's Tau)</th>
                                    <td>{{ kendall|floatformat:2 }}</td>
                                </tr>
                            </tbody>
                        </table>
                        <p>ê°’ì´ 1ì´ë‚˜ -1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°•í•œ ì–‘ ë˜ëŠ” ìŒì˜ ìƒê´€ê´€ê³„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ìƒê´€ê³„ìˆ˜ ê°’ì´ -100ì¸ ê²½ìš° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ë¬¸ì œê°€ ë°œìƒí–ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
                    </div>
                    -->
                </div>
            </p>
            <hr style="height: 5px; background-color: green;">
            <p>
                <div class="row">
                    <div class="col-lg-6 column-divider">
                        <div class="btn-group mb-3" role="group" aria-label="Chart Toggles">
                            <button type="button" class="btn btn-secondary" onclick="showChart('btc-dominance')">BTC ë„ë¯¸ë„ŒìŠ¤</button>
                            <button type="button" class="btn btn-secondary" onclick="showChart('eth-dominance')">ETH ë„ë¯¸ë„ŒìŠ¤</button>
                            <button type="button" class="btn btn-secondary" onclick="showChart('nasdaq')">NASDAQ</button>
                            <button type="button" class="btn btn-secondary" onclick="showChart('gold')">Gold</button>
                        </div>
                        <div id="btc-dominance" class="chart-container">
                            <div class="tradingview-widget-container dominance-chart">
                                <h5>BTC ë„ë¯¸ë„ŒìŠ¤</h5>
                                <p>ì „ì²´ ì•”í˜¸í™”í ì‹œì¥ì—ì„œ ë¹„íŠ¸ì½”ì¸ì´ ì°¨ì§€í•˜ëŠ” ì‹œê°€ì´ì•¡ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ ì§€í‘œëŠ” ì‹œì¥ ë‚´ì—ì„œ ë¹„íŠ¸ì½”ì¸ì˜ ì˜í–¥ë ¥ì„ ì¸¡ì •í•˜ëŠ”ë° ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
                                <!-- TradingView Widget BEGIN -->
                                <div class="tradingview-widget-container dominance-container" id="btc-dominance_">
                                      <div class="tradingview-widget-container__widget" style="height:300px;width:100%"></div>
                                      <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
                                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                                          {
                                              "autosize": true,
                                              "symbol": "CRYPTOCAP:BTC.D",
                                              "interval": "D",
                                              "timezone": "Etc/UTC",
                                              "theme": "light",
                                              "style": "1",
                                              "locale": "en",
                                              "enable_publishing": false,
                                              "allow_symbol_change": true,
                                              "calendar": false,
                                              "support_host": "https://www.tradingview.com"
                                          }
                                      </script>
                                </div>
                            </div>
                        </div>
                        <div id="eth-dominance" class="chart-container" style="display:none;">
                            <div class="tradingview-widget-container dominance-chart">
                                <h5>ETH ë„ë¯¸ë„ŒìŠ¤</h5>
                                <p>ì „ì²´ ì•”í˜¸í™”í ì‹œì¥ì—ì„œ ì´ë”ë¦¬ì›€ì´ ì°¨ì§€í•˜ëŠ” ì‹œê°€ì´ì•¡ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ëŠ” ì´ë”ë¦¬ì›€ì˜ ì‹œì¥ ë‚´ ì§€ë°°ë ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì…ë‹ˆë‹¤.</p>
                                <!-- TradingView Widget BEGIN -->
                                <div class="tradingview-widget-container dominance-container" id="eth-dominance_">
                                      <div class="tradingview-widget-container__widget" style="height:400px;width:100%"></div>
                                      <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
                                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                                          {
                                              "autosize": true,
                                              "symbol": "CRYPTOCAP:ETH.D",
                                              "interval": "D",
                                              "timezone": "Etc/UTC",
                                              "theme": "light",
                                              "style": "1",
                                              "locale": "en",
                                              "enable_publishing": false,
                                              "allow_symbol_change": true,
                                              "calendar": false,
                                              "support_host": "https://www.tradingview.com"
                                          }
                                      </script>
                                </div>
                                <!-- TradingView Widget END -->
                            </div>
                        </div>
                        <div id="nasdaq" class="chart-container" style="display:none;">
                            <div class="tradingview-widget-container dominance-chart">
                                <h5>NASDAQ</h5>
                                <p>US 100 Cash CFDëŠ” NASDAQ 100 ì§€ìˆ˜ë¥¼ ì¶”ì í•˜ëŠ” ê³„ì•½ì…ë‹ˆë‹¤. ì´ëŠ” ë¯¸êµ­ ê¸°ìˆ ì£¼ ì‹œì¥ì˜ ì„±ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œë¡œ í™œìš©ë©ë‹ˆë‹¤.</p>
                                <!-- TradingView Widget BEGIN -->
                                <div class="tradingview-widget-container dominance-container" id="NAS100" style="height:100%;width:100%">
                                      <div class="tradingview-widget-container__widget" style="height:100%;width:100%"></div>
                                      <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
                                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                                          {
                                              "autosize": true,
                                              "symbol": "FOREXCOM:NAS100",
                                              "interval": "D",
                                              "timezone": "Etc/UTC",
                                              "theme": "light",
                                              "style": "1",
                                              "locale": "en",
                                              "enable_publishing": false,
                                              "allow_symbol_change": true,
                                              "calendar": false,
                                              "support_host": "https://www.tradingview.com"
                                          }
                                      </script>
                                </div>
                                <!-- TradingView Widget END -->
                            </div>
                        </div>
                        <div id="gold" class="chart-container" style="display:none;">
                            <div class="tradingview-widget-container dominance-chart">
                                <h5>Gold</h5>
                                <p>Gold CFDsëŠ” ê¸ˆ(US$/OZ)ì— ëŒ€í•œ ì°¨ì•¡ê²°ì œ ê³„ì•½ìœ¼ë¡œ, ì‹¤ì œ ê¸ˆì„ ì†Œìœ í•˜ì§€ ì•Šê³ ë„ ê¸ˆ ê°€ê²©ì˜ ë³€ë™ì— íˆ¬ìí•  ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨ì…ë‹ˆë‹¤.</p>
                                <!-- TradingView Widget BEGIN -->
                                <div class="tradingview-widget-container dominance-container" id="gold_" style="height:100%;width:100%">
                                      <div class="tradingview-widget-container__widget" style="height:100%;width:100%"></div>
                                      <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
                                      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                                          {
                                              "autosize": true,
                                              "symbol": "TVC:GOLD",
                                              "interval": "D",
                                              "timezone": "Etc/UTC",
                                              "theme": "light",
                                              "style": "1",
                                              "locale": "en",
                                              "enable_publishing": false,
                                              "allow_symbol_change": true,
                                              "calendar": false,
                                              "support_host": "https://www.tradingview.com"
                                          }
                                      </script>
                                </div>
                                <!-- TradingView Widget END -->
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="investment-calendar-container my-4">
                            <h3>ê²½ì œ ìº˜ë¦°ë”</h3>
                            <iframe src="https://sslecal2.investing.com?borderColor=%2310b316&columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&features=datepicker,timezone&countries=5,4,72,14,35,37,6,122,11,39&calType=week&timeZone=88&lang=18" width="auto" height="300" frameborder="0" allowtransparency="true" marginwidth="0" marginheight="0"></iframe>
                            <div class="poweredBy" style="font-family: Arial, Helvetica, sans-serif;">
                                <span style="font-size: 11px;color: #333333;text-decoration: none;">ì™¸í™˜ í¬í„¸ <a href="https://kr.Investing.com/" rel="nofollow" target="_blank" style="font-size: 11px;color: #06529D; font-weight: bold;" class="underline_link">Investing.com í•œêµ­ì–´</a>.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </p>
            <hr style="height: 5px; background-color: green;">
            <div class="row">
                <div class="col-lg-4 column-divider">
                    <div class="container mt-4">
                            <h5 class="mb-4">ì‹¤ì‹œê°„ ê³ ë˜ ì •ë³´ ì•Œë¦¼</h5>
                            <div class="btn-group mb-3 d-inline-block" role="group" aria-label="Platform Toggle">
                                <button type="button" class="btn btn-outline-secondary btn-sm">
                                    <img src="{% static 'whaleliq.png' %}" alt="byun Icon" style="height: 30px; margin-right: 5px;">
                                    <a href="https://t.me/whaleliq">@whaleliq</a>
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm">
                                    <img src="{% static 'whalealert.png' %}" alt="whalealert Icon" style="height: 30px; margin-right: 5px;">
                                    <a href="https://t.me/whalealertkorean">@whalealertkorean</a>
                                </button>
                            </div>
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                                {% for channel, messages in telegram_messages.items %}
                                    {% if channel|exclude_channels:'@crypto_gazua,@shrimp_notice,@xangle_official_kr' %}
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link {% if channel == '@whaleliq' %}active{% endif %}" id="{{ channel|cut:'@'|add:'-tab-whale' }}" data-toggle="tab" href="#{{ channel|cut:'@'|add:'-content-whale' }}" role="tab" aria-controls="{{ channel|cut:'@'|add:'-content-whale' }}" aria-selected="{% if channel == '@whaleliq' %}true{% else %}false{% endif %}">
                                                {{ channel }}
                                            </a>
                                        </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                            <!-- Tab content -->
                            <div class="tab-content" id="myTabContent">
                                {% for channel, messages in telegram_messages.items %}
                                    <div class="tab-pane fade {% if channel == '@whaleliq' %}show active{% endif %}" id="{{ channel|cut:'@'|add:'-content-whale' }}" role="tabpanel" aria-labelledby="{{ channel|cut:'@'|add:'-tab-whale' }}">
                                        {% if messages %}
                                            <div class="table-responsive">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>Message</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {% for message in messages %}
                                                            <tr>
                                                                <td>{{ message|truncatewords_by:35 }}</td>
                                                            </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        {% else %}
                                            <p>ì •ë³´ë¥¼ ê¸ì–´ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                                        {% endif %}
                                    </div>
                                {% endfor %}
                            </div>
                    </div>
                </div>
                <div class="col-lg-4 column-divider">
                    <div class="container mt-4">
                        <h5 class="mb-4">ìµœê·¼ ê±°ë˜ì†Œ ìƒì¥ ë° ê³µì§€ ì•Œë¦¼</h5>
                        <div class="btn-group mb-3 d-inline-block" role="group" aria-label="Platform Toggle">
                            <button type="button" class="btn btn-outline-secondary btn-sm">
                                <img src="{% static 'crypto_gazua.png' %}" alt="crypto_gazua Icon" style="height: 30px; margin-right: 5px;">
                                <a href="https://t.me/s/crypto_gazua">@crypto_gazua</a>
                            </button>
                            <button type="button" class="btn btn-outline-secondary btn-sm">
                                <img src="{% static 'shrimp_notice.png' %}" alt="shrimp_notice Icon" style="height: 30px; margin-right: 5px;">
                                <a href="https://t.me/s/shrimp_notice">@shrimp_notice</a>
                            </button>
                        </div>
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs" id="myTab2" role="tablist">
                            {% for channel, messages in telegram_messages.items %}
                                {% if channel|exclude_channels:'@whalealertkorean,@whaleliq,@xangle_official_kr' %}
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link {% if forloop.first %}active{% endif %}" id="{{ channel|cut:'@'|add:'-tab-exchange' }}" data-toggle="tab" href="#{{ channel|cut:'@'|add:'-content-exchange' }}" role="tab" aria-controls="{{ channel|cut:'@'|add:'-content-exchange' }}" aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">
                                            {{ channel }}
                                        </a>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                        <!-- Tab content -->
                        <div class="tab-content" id="myTabContent2">
                            {% for channel, messages in telegram_messages.items %}
                                <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="{{ channel|cut:'@'|add:'-content-exchange' }}" role="tabpanel" aria-labelledby="{{ channel|cut:'@'|add:'-tab-exchange' }}">
                                    {% if messages %}
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>Message</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for message in messages %}
                                                        <tr>
                                                            <td>{{ message }}</td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    {% else %}
                                        <p>ì •ë³´ë¥¼ ê¸ì–´ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 column-divider">
                    <div class="container mt-4">
                        <h5 class="mb-4">ìŸê¸€(Xangle) ì´ë²¤íŠ¸ ì±„ë„ ì•Œë¦¼</h5>
                        <div class="btn-group mb-3 d-inline-block" role="group" aria-label="Platform Toggle">
                            <button type="button" class="btn btn-outline-secondary btn-sm">
                                <img src="{% static 'xangle.jpeg' %}" alt="xangle Icon" style="height: 30px; margin-right: 5px;">
                                <a href="https://t.me/s/xangle_official_kr">@xangle_official_kr</a>
                            </button>
                        </div>
                        <ul class="nav nav-tabs" id="myTab3" role="tablist">
                            {% for channel, messages in telegram_messages.items %}
                                {% if channel|exclude_channels:'@whalealertkorean,@whaleliq,@crypto_gazua,@shrimp_notice' %}
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link {% if channel == '@xangle_official_kr' %}active{% endif %}"
                                           id="{{ channel|cut:'@'|add:'-tab-xangle' }}"
                                           data-bs-toggle="tab"
                                           href="#{{ channel|cut:'@'|add:'-content-xangle' }}"
                                           role="tab"
                                           aria-controls="{{ channel|cut:'@'|add:'-content-xangle' }}"
                                           aria-selected="{% if channel == '@xangle_official_kr' %}true{% else %}false{% endif %}">
                                            {{ channel }}
                                        </a>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                        <div class="tab-content" id="xangleTabContent">
                            {% for channel, messages in telegram_messages.items %}
                                <div class="tab-pane fade {% if channel == '@xangle_official_kr' %}show active{% endif %}"
                                     id="{{ channel|cut:'@'|add:'-content-xangle' }}"
                                     role="tabpanel"
                                     aria-labelledby="{{ channel|cut:'@'|add:'-tab-xangle' }}">
                                    {% if messages %}
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>Message</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for message in messages %}
                                                        <tr>
                                                            <td>{{ message }}</td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    {% else %}
                                        <p>ì •ë³´ë¥¼ ê¸ì–´ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <hr style="height: 5px; background-color: green;">
            <p>
                <div class="row">
                    <div class="col-lg-6 column-divider">
                        <a href="https://www.coinness.com" target="_blank" style="text-decoration: none; color: inherit;">
                            <img src="{% static 'coinness.png' %}" alt="Coinness Icon" style="vertical-align: middle; margin-right: 5px; height: 30px;">
                        </a>
                        <strong>ì½”ì¸ë‹ˆìŠ¤ ìµœì‹  ì†ë³´</strong>
                        <br><br>
                        <div class="d-flex justify-content-center">
                            <div class="news-table w-100">
                                <div class="loading-indicator" style="display: none; text-align: center;">ìµœì‹  ì†ë³´ë¥¼ ì½ì–´ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤... ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</div>
                                {% for item in scraped_data %}
                                    <div class="news-row">
                                        <div class="news-cell title-cell" data-tooltip="{{ item.contents }}">
                                            <span class="news-title">{{ item.titles }}</span>
                                        </div>
                                        <div class="news-cell datetime-cell">
                                            <span class="news-datetime">{{ item.datetimes|date:"Y-m-d H:i" }}</span>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="additional-news">
                            <h4 class="additional-news-heading">ë” ë§ì€ ì½”ì¸ ì†Œì‹ì„ ì ‘í•´ë³´ì„¸ìš”</h4>
                            <ul class="list-unstyled news-links">
                                <li><strong><a href="https://www.coinpickle.net/community/news/new#google_vignette">ì½”ì¸í”¼í´</a>:</strong> ê°€ìƒí™”í íˆ¬ìì˜ ì§€ë¦„ê¸¸, ì •í™•í•œ ë°ì´í„°ë¡œ ì—¬ì •ì„ ì‹œì‘í•˜ì„¸ìš”</li>
                                <li><strong><a href="https://www.blockmedia.co.kr/">ë¸”ë¡ë¯¸ë””ì–´</a>:</strong> ë””ì§€í„¸ìì‚°ì„ ë¶„ì„í•˜ëŠ” ì „ë¬¸ê°€, ê¸°ìê°€ ë§Œë“  ê¸€ë¡œë²Œ No.1 ì¢…í•©ë¯¸ë””ì–´</li>
                                <li><strong><a href="https://www.tokenpost.kr/">í† í°í¬ìŠ¤íŠ¸</a>:</strong> EconoTimesì™€ í•¨ê»˜í•˜ëŠ” ë¸”ë¡ì²´ì¸ ë° ë””ì§€í„¸ ìì‚° ì „ë¬¸ ë¯¸ë””ì–´</li>
                                <li><strong><a href="https://www.blockstreet.co.kr/coin-news">ë¸”ë¡ìŠ¤íŠ¸ë¦¬íŠ¸</a>:</strong> ê²½ì œë¯¸ë””ì–´ ë‰´ìŠ¤ì›¨ì´ê°€ ìš´ì˜í•˜ëŠ” ê°€ìƒìì‚° ì „ë¬¸ ë¯¸ë””ì–´</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <strong> ë”¥ëŸ¬ë‹ ì–¸ì–´ëª¨ë¸ ë¹„íŠ¸ì½”ì¸ ê°ì„± ì ìˆ˜ </strong>
                        <p><small>ìµœê·¼ ì½”ì¸ë‹ˆìŠ¤ ì†ë³´ë“¤ì´ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì— ì–¼ë§Œí¼ í˜¸ì¬, ì•…ì¬, ì¤‘ë¦½ì„±ì„ ë„ê³  ìˆëŠ”ì§€ CryptoDeBERTa ì–¸ì–´ëª¨ë¸ì´ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤. ì•„ì´íŒŒë¹„íŠ¸ ì¸ê³µì§€ëŠ¥ ì—°êµ¬íŒ€ì´ ê°œë°œí•œ ê°ì„±ë¶„ë¥˜ ì–¸ì–´ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì¹˜ê°€ ê³„ì‚°ë˜ì—ˆìŠµë‹ˆë‹¤.</small></p>
                        <button type="button" class="btn btn-outline-secondary btn-sm">
                                <a href="https://huggingface.co/LDKSolutions/KR-cryptodeberta-v2-base"><img src="{% static 'huggingface.png' %}" alt="settings" style="height:40px; margin-right: 5px;">ì•„ì´íŒŒë¹„íŠ¸ í¬ë¦½í†  ì–¸ì–´ëª¨ë¸</a>
                        </button>
                        <div class="sentiment-scores">
                            {% for score in avg_sentiment_scores_percentage %}
                                <div class="sentiment-score">
                                    <span class="sentiment-label">{{ sentiment_labels|get_item:forloop.counter0 }}:</span>
                                    <div class="sentiment-bar" style="width: {{ score }}%;"></div>
                                    <span class="sentiment-text" style="color: black;">{{ score|floatformat:2 }}%</span>
                                </div>
                            {% endfor %}
                        </div>
                        <div>
                            <strong>[ìœ ì € íˆ¬í‘œ] ë¹„íŠ¸ì½”ì¸ì— ëŒ€í•´ì„œ ì–´ë–»ê²Œ ìƒê°í•˜ì‹œë‚˜ìš”?</strong>
                            <div class="voting-container">
                                <form id="sentimentVoteForm" action="{% url 'aiphabtc:submit_sentiment_vote' %}" method="post">
                                    {% csrf_token %}
                                    {% for option in sentiment_voting_options %}
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="sentimentVoteOption" id="sentimentVoteOption{{ option.id }}" value="{{ option.id }}">
                                        <label class="form-check-label" for="sentimentVoteOption{{ option.id }}">
                                            {{ option.name }}
                                        </label>
                                    </div>
                                    {% endfor %}
                                    <button type="submit" class="btn btn-primary btn-block">Submit Vote</button>
                                </form>
                            </div>
                            <button class="btn btn-info mt-3" type="button" data-toggle="collapse" data-target="#sentimentResults" aria-expanded="false" aria-controls="sentimentResults">
                                ìœ ì € ëˆ„ì  íˆ¬í‘œ ê²°ê³¼ ë³´ê¸° (%)
                            </button>
                            <div class="collapse" id="sentimentResults">
                                <div class="card card-body">
                                    <canvas id="sentimentPieChart"></canvas> <!-- Canvas for Chart.js -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </p>
            <hr style="height: 5px; background-color: green;">
            <!-- add advertisement banners here --> <!-- get rid of this section for now -->
            <!--
            <div class="row">
                <div class="col-lg-6 column-divider">
                    <div>
                        <strong>ë¹„íŠ¸ì½”ì¸ì— ëŒ€í•´ì„œ ì–´ë–»ê²Œ ìƒê°í•˜ì‹œë‚˜ìš”?</strong>
                        <div class="voting-container">
                            <form id="sentimentVoteForm" action="{% url 'aiphabtc:submit_sentiment_vote' %}" method="post">
                                {% csrf_token %}
                                {% for option in sentiment_voting_options %}
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="sentimentVoteOption" id="sentimentVoteOption{{ option.id }}" value="{{ option.id }}">
                                    <label class="form-check-label" for="sentimentVoteOption{{ option.id }}">
                                        {{ option.name }}
                                    </label>
                                </div>
                                {% endfor %}
                                <button type="submit" class="btn btn-primary btn-block">Submit Vote</button>
                            </form>
                        </div>
                        <button class="btn btn-info mt-3" type="button" data-toggle="collapse" data-target="#sentimentResults" aria-expanded="false" aria-controls="sentimentResults">
                            ìœ ì € ëˆ„ì  íˆ¬í‘œ ê²°ê³¼ ë³´ê¸° (%)
                        </button>
                        <div class="collapse" id="sentimentResults">
                            <div class="card card-body">
                                <canvas id="sentimentPieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="row">
                        <div class="col-md-6 advertisement-container">
                            <div class="ad-label"><strong>ì¶”ì²œ ìœ íŠœë¸Œ ì±„ë„</strong></div>
                            <a href="https://www.youtube.com/@Coin-Issue" target="_blank">
                                <img src="{% static 'coinissue_ad2.png' %}" class="img-fluid advertisement-image">
                            </a>
                        </div>
                        <div class="col-md-6 advertisement-container">
                            <div class="ad-label"><strong>ì¶”ì²œ íˆ¬ìë´‡ êµìœ¡ ì›¹ì‚¬ì´íŠ¸</strong></div>
                            <a href="http://quantylab.com/" target="_blank">
                                <img src="{% static 'quantylab_ad2.png' %}" class="img-fluid advertisement-image">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <hr style="height: 5px; background-color: green;">
            -->
        </div>
    </div>
</div>
<div class="footer">
    <p>ìƒí˜¸ëª…: ì£¼ì‹íšŒì‚¬ ì•„ì´íŒŒë¹„íŠ¸ | ëŒ€í‘œì: ê¹€ë¯¼ì„ | ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸: 385-87-03253 | ì´ë©”ì¼: aiphabtcbusiness11235@gmail.com</p>
    <p>ì£¼ì†Œ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ86ê¸¸ 15, 3ì¸µ 327í˜¸ (ëŒ€ì¹˜ë™, ë™êµ¬ë¹Œë”©) | ì—…íƒœ: ì •ë³´í†µì‹ ì—…</p>
    <p>ì•„ì´íŒŒë¹„íŠ¸ëŠ” ì¸ê³µì§€ëŠ¥ê³¼ ë¹„íŠ¸ì½”ì¸ ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤. ì œê³µë˜ëŠ” ì§€í‘œì™€ ë´‡ì€ íˆ¬ì ê¶Œìœ  ëª©ì ì´ ì•„ë‹˜ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.</p>
    <p><a href="https://blog.naver.com/aiphabtc11235"><img src="{% static 'naver.png' %}" alt="naver logo" style="height: 30px; margin-right: 5px;">AIPHABTC ë¸”ë¡œê·¸</a></p>
</div>
{% endblock %}


{% block javascript %}
{{ block.super }}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Initialize tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    fetchNewsAndSentiment();
    document.getElementById('fetchTechnicalAIResponse').addEventListener('click', function() {
        fetchTechnicalAIResponse();
    });

    document.getElementById('fetchTechnicalAIResponse1m').addEventListener('click', function() {
        fetchTechnicalAIResponse1m();
    });

    document.querySelector('.voting-container form').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);

        fetch("/aiphabtc/submit_sentiment_vote/", {
            method: 'POST',
            credentials: 'include',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            },
        })
        .then(response => {
            if (!response.ok) {
                // This block handles the scenario where the user is not logged in.
                // Since we cannot directly detect a 302 redirect here, you need another way to identify unauthenticated requests.
                // Consider implementing a custom response header in your Django view that you can check here.
                throw new Error('User not authenticated');
            }
            return response.json();
        })
        .then(data => {
            alert(data.message);
            fetchAndUpdatePieChart();
        })
        .catch(error => {
            // Redirect the user to the login page with the index page set as the next URL.
            window.location.href = "/common/login/?next=/" + encodeURIComponent('aiphabtc/');
        });
    });


    // Initialize the pie chart here to ensure the DOM is fully loaded
    // Moved the chart initialization to a separate function for clarity
    // initializePieChart();
    fetchAndUpdatePieChart();
});

function showChart(chartId) {
    // List of all chart container IDs
    const charts = ['btc-dominance', 'eth-dominance', 'nasdaq', 'gold'];
    // Hide all charts
    charts.forEach(id => {
        document.getElementById(id).style.display = 'none';
    });
    // Show the selected chart
    document.getElementById(chartId).style.display = 'block';
}


function fetchNewsAndSentiment() {
    // Show the loading indicator
    const loadingIndicator = document.querySelector('.loading-indicator');
    loadingIndicator.style.display = 'block'; // Show loading indicator

    fetch('{% url "aiphabtc:get_news_and_sentiment" %}')
    .then(response => response.json())
    .then(data => {
        // Hide the loading indicator
        loadingIndicator.style.display = "none"; // Hide loading indicator after fetching

        // Extract data from the response
        const { scraped_data, avg_sentiment_scores_percentage, sentiment_labels } = data;

        // Update the news section
        const newsContainer = document.querySelector('.news-table');
        newsContainer.innerHTML = ''; // Clear existing news
        scraped_data.forEach(item => {
            const newsRow = document.createElement('div');
            newsRow.className = 'news-row';

            // Escape double quotation marks in the content
            const escapedContent = item.contents.replace(/"/g, '&quot;');
            newsRow.innerHTML = `
                <div class="news-cell title-cell" data-tooltip="${escapedContent}">
                    <span class="news-title">${item.titles}</span>
                </div>
                <div class="news-cell datetime-cell">
                    <span class="news-datetime">${new Date(item.datetimes).toLocaleString()}</span>
                </div>
            `;
            newsContainer.appendChild(newsRow);
        });

        // Update the sentiment scores section
        const sentimentScoresContainer = document.querySelector('.sentiment-scores');
        sentimentScoresContainer.innerHTML = ''; // Clear existing scores
        avg_sentiment_scores_percentage.forEach((score, index) => {
            const sentimentScoreDiv = document.createElement('div');
            sentimentScoreDiv.className = 'sentiment-score';
            const sentimentBar = document.createElement('div');
            sentimentBar.className = 'sentiment-bar';
            sentimentBar.style.width = `${score}%`;
            const sentimentText = document.createElement('span');
            sentimentText.className = 'sentiment-text';
            sentimentText.style.color = 'black';
            sentimentText.innerText = `${score}%`;

            sentimentScoreDiv.innerHTML = `<span class="sentiment-label">${sentiment_labels[index]}:</span>`;
            sentimentScoreDiv.appendChild(sentimentBar);
            sentimentScoreDiv.appendChild(sentimentText);

            sentimentScoresContainer.appendChild(sentimentScoreDiv);
        });
    })
    .catch(error => {
        console.error('Error fetching news and sentiment:', error);
        // Hide the loading indicator even if there is an error
        loadingIndicator.style.display = "none";
    });
}

function fetchTechnicalAIResponse() {
    // Show the loading message
    document.getElementById('TechnicalLoading').style.display = 'block';
    document.getElementById('TechnicalAIResponse').innerHTML = ''; // Clear previous response

    // Make the AJAX request
    fetch('{% url "aiphabtc:fetch_gpt_analysis" %}')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        // Hide the loading message
        document.getElementById('TechnicalLoading').style.display = 'none';

        // Update the DOM with the response
        document.getElementById('TechnicalAIResponse').innerHTML = data.chat_message;
    })
    .catch((error) => {
        console.error('Error:', error);
        document.getElementById('TechnicalLoading').style.display = 'none';
        document.getElementById('TechnicalAIResponse').innerHTML = 'Sorry, there was a problem fetching the analysis. ë¶„ì„ì„ ê°€ì ¸ì˜¤ëŠ”ë° ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.';
    });
}

function fetchTechnicalAIResponse1m() {
    // Show the loading message
    document.getElementById('TechnicalLoading1m').style.display = 'block';
    document.getElementById('TechnicalAIResponse1m').innerHTML = ''; // Clear previous response

    // Make the AJAX request
    fetch('{% url "aiphabtc:fetch_gpt_analysis_1m" %}')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        // Hide the loading message
        document.getElementById('TechnicalLoading1m').style.display = 'none';

        // Update the DOM with the response
        document.getElementById('TechnicalAIResponse1m').innerHTML = data.chat_message;
    })
    .catch((error) => {
        console.error('Error:', error);
        document.getElementById('TechnicalLoading1m').style.display = 'none';
        document.getElementById('TechnicalAIResponse1m').innerHTML = 'Sorry, there was a problem fetching the analysis. ë¶„ì„ì„ ê°€ì ¸ì˜¤ëŠ”ë° ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.';
    });
}


function fetchAndUpdatePieChart() {
    fetch("{% url 'aiphabtc:latest_voting_data' %}", {
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
        },
    })
    .then(response => response.json())
    .then(data => {
        // Assuming initializePieChart() can take data as a parameter and update the chart
        initializePieChart(data); // Modify initializePieChart as needed
    })
    .catch(error => console.error('Error fetching latest voting data:', error));
}

function initializePieChart(data) {
    var ctx = document.getElementById("sentimentPieChart").getContext("2d");
    // Ensure previous chart instance is destroyed before creating a new one
    if (window.myPieChart) window.myPieChart.destroy();

    // Define background colors for sentiments
    const backgroundColors = [
        'grey','darkred','red','green','darkgreen',
    ];

    window.myPieChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [{
                data: data.data,
                backgroundColor: backgroundColors,
                borderColor: '#ffffff', // White borders for each slice
                borderWidth: 2, // Border width
            }],
        },
        options: {
            scales: {
                y: {  // Changed from 'yAxes' to 'y' for Chart.js v3+
                    beginAtZero: true,
                    ticks: {
                        precision: 0  // Optional: No decimal places on y-axis ticks
                    }
                }
            },
            responsive: true,
            plugins: {  // 'legend' and 'tooltip' settings are now under 'plugins'
                legend: {
                    display: false,
                    position: 'top'
                },
                tooltip: {
                    enabled: true  // Enable tooltips
                }
            },
            animation: {
                animateScale: true,
                animateRotate: true
            }
        }
    });
}
</script>
{% endblock %}